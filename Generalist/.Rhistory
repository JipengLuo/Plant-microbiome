# 安装EcoLUtils包
# devtools::install_github("GuillemSalazar/EcolUtils")
library(EcolUtils)
# 安装EcoLUtils包
devtools::install_github("GuillemSalazar/EcolUtils")
# 安装EcoLUtils包
devtools::install_github("GuillemSalazar/EcolUtils")
library(vegan)
library(spaa)
install.packages("spaa")
library(spaa)
library(EcolUtils)
# 安装EcoLUtils包
devtools::install_github("GuillemSalazar/EcolUtils")
# 安装EcoLUtils包
devtools::install_github("GuillemSalazar/EcolUtils")
remotes::install_github("user/repo")
git ls-remote https://github.com/user/repo.git
library(vegan)
usethis::edit_r_environ()
remotes::install_github("user/repo")
gitcreds::gitcreds_set()
Sys.getenv("GITHUB_PAT")
usethis::edit_r_environ()
usethis::edit_r_environ()
# 安装EcoLUtils包
devtools::install_github("GuillemSalazar/EcolUtils")
library(EcolUtils)
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("RPKM.KOs.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(!grepl("unirrigated", colnames(comm.tab1)))]  # Select samples
# Or
library(dplyr)
comm.tab <- comm.tab1 %>% select(matches("^irrigated"))
View(comm.tab1)
# comm.tab <- comm.tab1[,rownames(design)]
# write.csv(comm.tab, file = "RPKM.KOs.count_74.csv")
comm.tab <- comm.tab[rowSums(comm.tab)>20,]  # 保留在所有样品中序列数之和>100的KOs
comm.tab <- t(comm.tab)
#comm.tab <- comm.tab[ ,which(colSums(comm.tab)>50)]
dim(comm.tab)
# 指定随机置换（permutation）的次数，用于生成空模型（null model）以比较实际数据与随机数据的生态位宽度
res <- spec.gen(comm.tab, niche.width.method = "levins", perm.method = "quasiswap", n= 1000, probs = c(0.025, 0.975))
table(res$sign)
# 对于非零的最大值，输出的数组元素通常会是 1（因为归一化后值在 [0, 1] 范围内，向上取整后都变成 1）
comm.tab.bin <- ceiling(comm.tab/max(comm.tab))
# res1 <- read.csv("Root_generalists.csv", row.names=1,header=TRUE)
plot(colSums(comm.tab), colSums(comm.tab.bin)/dim(comm.tab.bin)[1],
col = res$sign, pch = 19, log="x", xlab = "Abundance", ylab = "Occurrence")
legend("bottomright", levels(res$sign), col= 1:3, pch= 19, inset= 0.01, cex= 1)
write.csv(res, file = "Irrigated_Generalists_KOs.csv")
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("RPKM.KOs.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
View(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
View(comm.tab)
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("RPKM.KOs.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
# 安装EcoLUtils包
# devtools::install_github("GuillemSalazar/EcolUtils")
library(vegan)
library(spaa)
library(EcolUtils)
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("RPKM.KOs.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
# Or  方法二
library(dplyr)
comm.tab <- comm.tab1 %>% select(matches("^irrigated"))
comm.tab <- comm.tab1[which(!grepl("unirrigated", colnames(comm.tab1)))]  # Select samples
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
colnames(comm.tab1)
comm.tab1[1:5,1:5]
colnames(comm.tab1)
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
comm.tab <- comm.tab1 %>% select(matches("^irrigated"))
dim(comm.tab)
comm.tab <- comm.tab1 %>% select(matches("^unirrigated"))
dim(comm.tab)
# comm.tab <- comm.tab1[,rownames(design)]
# write.csv(comm.tab, file = "RPKM.KOs.count_74.csv")
comm.tab <- comm.tab[rowSums(comm.tab)>20,]  # 保留在所有样品中序列数之和>100的KOs
comm.tab <- t(comm.tab)
#comm.tab <- comm.tab[ ,which(colSums(comm.tab)>50)]
dim(comm.tab)
# 指定随机置换（permutation）的次数，用于生成空模型（null model）以比较实际数据与随机数据的生态位宽度
res <- spec.gen(comm.tab, niche.width.method = "levins", perm.method = "quasiswap", n= 1000, probs = c(0.025, 0.975))
table(res$sign)
# 对于非零的最大值，输出的数组元素通常会是 1（因为归一化后值在 [0, 1] 范围内，向上取整后都变成 1）
comm.tab.bin <- ceiling(comm.tab/max(comm.tab))
# res1 <- read.csv("Root_generalists.csv", row.names=1,header=TRUE)
plot(colSums(comm.tab), colSums(comm.tab.bin)/dim(comm.tab.bin)[1],
col = res$sign, pch = 19, log="x", xlab = "Abundance", ylab = "Occurrence")
legend("bottomright", levels(res$sign), col= 1:3, pch= 19, inset= 0.01, cex= 1)
write.csv(res, file = "Unirrigated_Generalists_KOs.csv")
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("RPKM.KOs.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
# comm.tab <- comm.tab1[,rownames(design)]
# write.csv(comm.tab, file = "RPKM.KOs.count_74.csv")
comm.tab <- comm.tab[rowSums(comm.tab)>0,]  # 保留在所有样品中序列数之和>100的KOs
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
colnames(comm.tab1)
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
# Or  方法二
library(dplyr)
comm.tab <- comm.tab1 %>% select(matches("^irrigated"))
dim(comm.tab)
comm.tab1[1:5,1:5]
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)))]  # Select samples
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1)，))]  # Select samples
comm.tab <- comm.tab1[which(!grepl("irrigated", colnames(comm.tab1),))]  # Select samples
comm.tab <- comm.tab1[which(grepl("irrigated", colnames(comm.tab1)))]  # Select samples
colnames(comm.tab1)
# Or  方法二
library(dplyr)
comm.tab <- comm.tab1 %>% select(matches("^irrigated"))
dim(comm.tab)
# comm.tab <- comm.tab1[,rownames(design)]
# write.csv(comm.tab, file = "RPKM.KOs.count_74.csv")
comm.tab <- comm.tab[rowSums(comm.tab)>0,]  # 保留在所有样品中序列数之和>100的KOs
comm.tab <- t(comm.tab)
#comm.tab <- comm.tab[ ,which(colSums(comm.tab)>50)]
dim(comm.tab)
# 指定随机置换（permutation）的次数，用于生成空模型（null model）以比较实际数据与随机数据的生态位宽度
res <- spec.gen(comm.tab, niche.width.method = "levins", perm.method = "quasiswap", n= 1000, probs = c(0.025, 0.975))
table(res$sign)
table(res$sign)
View(comm.tab1)
write.csv(res, file = "Irrigated_Generalists_KO_count.csv")
View(design)
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("RPKM.KOs.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(grepl("non-irrigated", colnames(comm.tab1)))]  # Select samples
colnames(comm.tab1)
comm.tab <- comm.tab1[which(grepl("unirrigated", colnames(comm.tab1))),]  # Select samples
View(comm.tab1)
colnames(comm.tab1)
View(comm.tab)
comm.tab <- comm.tab1[which(grepl("unirrigated", colnames(comm.tab1)))]  # Select samples
comm.tab <- comm.tab1[which(grepl("unirrigated", colnames(comm.tab1)))]  #Select unirrigated columns
# Or  方法二
library(dplyr)
comm.tab <- comm.tab1 %>% select(matches("^unirrigated")) # ^通配符
comm.tab02 <- comm.tab1 %>% select(matches("^unirrigated")) # ^通配符
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(grepl("unirrigated", colnames(comm.tab1)))]  #Select unirrigated columns
# comm.tab <- comm.tab1[,rownames(design)]
# write.csv(comm.tab, file = "RPKM.KOs.count_74.csv")
comm.tab <- comm.tab[rowSums(comm.tab)>0,]  # 保留在所有样品中序列数之和>100的KOs
comm.tab <- t(comm.tab)
#comm.tab <- comm.tab[ ,which(colSums(comm.tab)>50)]
dim(comm.tab)
# 指定随机置换（permutation）的次数，用于生成空模型（null model）以比较实际数据与随机数据的生态位宽度
res <- spec.gen(comm.tab, niche.width.method = "levins", perm.method = "quasiswap", n= 1000, probs = c(0.025, 0.975))
table(res$sign)
table(res$sign)
# 对于非零的最大值，输出的数组元素通常会是 1（因为归一化后值在 [0, 1] 范围内，向上取整后都变成 1）
comm.tab.bin <- ceiling(comm.tab/max(comm.tab))
# res1 <- read.csv("Root_generalists.csv", row.names=1,header=TRUE)
plot(colSums(comm.tab), colSums(comm.tab.bin)/dim(comm.tab.bin)[1],
col = res$sign, pch = 19, log="x", xlab = "Abundance", ylab = "Occurrence")
legend("bottomright", levels(res$sign), col= 1:3, pch= 19, inset= 0.01, cex= 1)
write.csv(res, file = "Unirrigated_Generalists_KO_count.csv")
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("Species.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(grepl("unirrigated", colnames(comm.tab1)))]  #Select unirrigated columns
# comm.tab <- comm.tab1[,rownames(design)]
# write.csv(comm.tab, file = "RPKM.KOs.count_74.csv")
comm.tab <- comm.tab[rowSums(comm.tab)>0,]  # 保留在所有样品中序列数之和>100的KOs
comm.tab <- t(comm.tab)
#comm.tab <- comm.tab[ ,which(colSums(comm.tab)>50)]
dim(comm.tab)
# 指定随机置换（permutation）的次数，用于生成空模型（null model）以比较实际数据与随机数据的生态位宽度
res <- spec.gen(comm.tab, niche.width.method = "levins", perm.method = "quasiswap", n= 1000, probs = c(0.025, 0.975))
table(res$sign)
# 对于非零的最大值，输出的数组元素通常会是 1（因为归一化后值在 [0, 1] 范围内，向上取整后都变成 1）
comm.tab.bin <- ceiling(comm.tab/max(comm.tab))
# res1 <- read.csv("Root_generalists.csv", row.names=1,header=TRUE)
plot(colSums(comm.tab), colSums(comm.tab.bin)/dim(comm.tab.bin)[1],
col = res$sign, pch = 19, log="x", xlab = "Abundance", ylab = "Occurrence")
legend("bottomright", levels(res$sign), col= 1:3, pch= 19, inset= 0.01, cex= 1)
write.csv(res, file = "Unirrigated_Generalists_Species_count.csv")
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(grepl("irrigated", colnames(comm.tab1)))]  #Select unirrigated columns
# Specialist/Generalist classification of OTUs based on niche width and permutation algorithms
# ASVs in row, samples in column
comm.tab1 <- read.csv("Species.count_74.csv", row.names=1, header=TRUE, check.names = FALSE)  #, comment.char="@"
comm.tab1[1:5,1:5]
colnames(comm.tab1)
design <- read.csv("Design_74_理化和坐标.csv", row.names=1, header=TRUE)
comm.tab <- comm.tab1[which(grepl("irrigated", colnames(comm.tab1)))]  #Select unirrigated columns
# Or  方法二
library(dplyr)
comm.tab02 <- comm.tab1 %>% select(matches("^irrigated")) # ^通配符
dim(comm.tab02)
View(comm.tab1)
colnames(comm.tab1)
comm.tab02 <- comm.tab1 %>% select(matches("^irrigated")) # ^通配符
dim(comm.tab02)
comm.tab <- comm.tab1 %>% select(matches("^irrigated")) # ^通配符
dim(comm.tab)
# comm.tab <- comm.tab1[,rownames(design)]
# write.csv(comm.tab, file = "RPKM.KOs.count_74.csv")
comm.tab <- comm.tab[rowSums(comm.tab)>0,]  # 保留在所有样品中序列数之和>100的KOs
comm.tab <- t(comm.tab)
#comm.tab <- comm.tab[ ,which(colSums(comm.tab)>50)]
dim(comm.tab)
# 指定随机置换（permutation）的次数，用于生成空模型（null model）以比较实际数据与随机数据的生态位宽度
res <- spec.gen(comm.tab, niche.width.method = "levins", perm.method = "quasiswap", n= 1000, probs = c(0.025, 0.975))
table(res$sign)
write.csv(res, file = "Irrigated_Generalists_Species_count.csv")
